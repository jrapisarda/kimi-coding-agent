# Agent Guidelines

## Mission
Deliver a local-first, multi-agent coding system that orchestrates Requirements → Coding → Testing → Documentation agents via a CLI, integrates the OpenAI Responses API & Agents SDK, runs in a sandbox with rollback safety, and persists all run artifacts to SQLite.

## Development Priorities
1. **Runnability & Reproducibility** – Enforce environment detection, capture seeds/versions, persist runs and artifacts, and package `dist/<run_id>.zip` for every execution.
2. **Safety & Compliance** – Maintain license guardrails (MIT/Apache/BSD only), redact secrets, sandbox subprocesses, and support snapshot/rollback with diagnostics.
3. **Current Ecosystem Usage** – Align scaffolding and templates with modern stacks (Next.js ≥15, FastAPI ≥0.118, pytest ≥8.4, pandas ≥2.3, scikit-learn ≥1.7). Verify via optional web search when available and record provenance.
4. **Quality Tooling** – Provide autogenerated smoke/unit tests (pytest/FE), documentation outputs (README, reproducibility notes), and progress streaming with structured logs.

## Process Expectations
- **CLI Contract** – Implement `agent run <target_path> [--input_docs <path>] [--prompt "..."]` with clear exit codes and error messages.
- **Orchestration** – Sequence the four agents with shared context schemas, retries/backoff, and concise run summaries.
- **Persistence** – Use SQLite as the single source of truth for runs, steps, artifacts, SBOM, provenance, and metrics.
- **Reference Scenarios** – Continuously validate against the four canonical user stories (Next.js dashboard, FastAPI CRUD, CSV↔SQLite ETL, scikit-learn pipeline) within a 10-minute target.

## Code & Collaboration Standards
- Structure modules for clarity (e.g., `cli`, `orchestrator`, `agents`, `persistence`, `sandbox`, `packaging`).
- Add thorough docstrings/comments for critical flows (snapshot/rollback, Responses API integration, provenance logging).
- Prefer typed Python (use `typing` and `pydantic`/`dataclasses` for schemas); enforce formatting/linting with Black and Ruff.
- Write pytest suites alongside implementation; ensure they run locally with coverage signals.
- Commit early and often with descriptive messages; package documentation for stakeholder review.

## Open Questions to Track
Document unresolved items (tool defaults, version policies, artifact retention, guardrails) in project notes and revisit at review checkpoints.

